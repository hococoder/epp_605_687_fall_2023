<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week05/04-MapInSwiftUI"/><meta name="twitter:url" content="https://hococoder.com/posts/Week05/04-MapInSwiftUI"/><meta name="og:url" content="https://hococoder.com/posts/Week05/04-MapInSwiftUI"/><title>Week 5 - Map in SwiftUI | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 5 - Map in SwiftUI | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 5 - Map in SwiftUI | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_fall_2023/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_fall_2023/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_fall_2023/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_fall_2023/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_fall_2023/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_fall_2023/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_fall_2023/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_fall_2023/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_fall_2023/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_fall_2023/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_fall_2023/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_fall_2023/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_fall_2023/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_fall_2023/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_fall_2023/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_fall_2023/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/epp_605_687_fall_2023/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 5 - Map in SwiftUI</h1><p style="float: left">Previous:  <A HREF="../03-CoreMotionExample/index.html">CoreMotion Example</A></p><p style="float: right">Next:  <A HREF="../05-IntroductionToCoreLocation/index.html" class="nextModule">Introduction to Core Location</A></p><BR/><BR/><h2>Overview</h2><p>While <code>MKMapView</code> has been around in the <code>MapKit</code> framework for years (more on that later), iOS 14 introduced a native Map view into SwiftUI for the first time. However, it is not as fully featured as the one in UIKit. In this module, we'll go over the SwiftUI <code>Map</code> view, talk about its limitations, and in later modules, we'll go over <code>MKMapView</code> from UIKit to see the full functionality that will hopefully one day come to SwiftUI.</p><h2>The <code>Map</code> View</h2><p>The <code>Map</code> View in SwiftUI is somewhat basic. It can:</p><ul><li>Display a region</li><li>Display the user location</li><li>Allow for <code>.pan</code> only, <code>.zoom</code> only, or <code>.all</code> interaction modes</li><li>Track the user's movement and update the map accordingly</li><li>Display annotations and draw on the map</li></ul><p>It cannot:</p><ul><li>Show directions</li><li>Handle large numbers of annotations well</li><li>Show the map in satellite view</li><li>Use custom map tiles</li></ul><p>There are several initializers that you can use, depending on what features you want to enable. The most basic takes in a <code>Binding&lt;MKCoordinateRegion&gt;</code>:</p><pre><code><span class="keyword">struct</span> SwiftUIMapView: <span class="type">View</span> {
  <span class="keyword">@State private var</span> region: <span class="type">MKCoordinateRegion</span>

  <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
    <span class="type">Map</span>(coordinateRegion: <span class="property">$region</span>)
  }

}
</code></pre><p>To define an <code>MKCoordinateRegion</code>, we need to define the latitude and longitude inside a <code>CLLocationCoordinate2D</code>, and the range of the map in <code>latitudinalMeters</code> and <code>longitudinalMeters</code>. <code>CLLocationCoordinate2D</code> actually comes from the <code>CoreLocation</code> framework, which we'll discuss next module. For now, just know it contains the location. Let's call the MyMapView with a passed in <code>MKCoordinateRegion</code> object (this code can be found in the EPExampleApp if you want to run it yourself).</p><pre><code><span class="type">SwiftUIMapView</span>(region: <span class="type">MKCoordinateRegion</span>(center: .<span class="keyword">init</span>(latitude: <span class="number">37.334722</span>, longitude: -<span class="number">122.008889</span>), 
                                            latitudinalMeters: <span class="number">300</span>, 
                                            longitudinalMeters: <span class="number">300</span>))
</code></pre><p>If you run that in the preview canvas and hit play (or run it in the simulator), you'll see a map centered on Apple's main campus, Apple Park:</p><img src="../../../week05/ApplePark.png#centerResized" alt="ApplePark"/><p>If you hold down Option over the simulator or preview canvas, the mouse pointer will turn into 2 circles - as you click and drag them either away or towards each other, the map will zoom in or zoom out respectively. You can also click on the map and pan the map in all directions. What if you wanted to restrict that capability?</p><h2>Restricting User Interactions</h2><p>If you would like to restrict the map's user interaction modes, you can use another initializer</p><pre><code><span class="type">Map</span>(coordinateRegion: <span class="property">$region</span>, interactionModes: [.<span class="dotAccess">all</span>])
</code></pre><p>This is actually part of a different initializer with 4 arguments, but we're taking advantage of the default values for the other 2. We'll talk about those shortly. The interaction modes can be:</p><ul><li><code>.zoom</code> - allows zooming in and out only</li><li><code>.pan</code> - allows panning around only</li><li><code>.all</code> - allows both zooming and panning.</li></ul><p>Try changing the value in the <code>interactionModes</code> argument to try out the behavior in either the preview canvas or simulator.</p><h2>User Location and User Tracking</h2><p>That larger initializer I mentioned above? Let's look at that:</p><pre><code><span class="keyword">@State var</span> userTrackingMode: <span class="type">MapUserTrackingMode</span> = <span class="type">MapUserTrackingMode</span>.<span class="property">follow</span>

<span class="comment">//....</span>

<span class="type">Map</span>(coordinateRegion: <span class="property">$region</span>, interactionModes: [.<span class="dotAccess">all</span>], showsUserLocation: <span class="keyword">true</span>, userTrackingMode: <span class="property">$userTrackingMode</span>)
</code></pre><p>This initializer introduces 2 new arguments:</p><ul><li><code>showsUserLocation</code> - if you've ever used Maps on iPhone before, you're very familiar with the "You are here" blue dot</li><li><code>$userTrackingMode</code> - a <code>Binding</code> that is used to specify whether the map will follow along with the user's movements; this can be <code>.follow</code> or <code>.none</code></li></ul><h2>Displaying Annotations</h2><p>There is one more initializer to talk about, and this one includes annotations. Although we can use defaults for some of the arguments here, let's look at the entire signature:</p><pre><code><span class="type">Map</span>(coordinateRegion: <span class="property">$region</span>, interactionModes: [.<span class="dotAccess">all</span>], showsUserLocation: <span class="keyword">true</span>, 
    userTrackingMode: <span class="property">$userTrackingMode</span>, annotationItems: annotations, annotationContent: { annotation <span class="keyword">in</span>
    <span class="comment">//annotation content goes here</span>
})
</code></pre><p>This initializer introduces 2 new arguments:</p><ul><li><code>annotationItems</code> - a collection of items representing the annotations</li><li><code>annotationContent</code> - a collection with the signature <code>Identifiable -&gt; MapAnnotationProtocol</code> that takes in an object that adopts <code>Identifiable</code> and returns an object that adopts <code>MapAnnotationProtocol</code></li></ul><p>Let's see what we need to do in order to create these annotations.</p><p>First, let's just start with one annotation. That collection of items for <code>annotationItems</code> can simply be represented by an array of locations, but we have to make sure they are <code>Identifiable</code>. Let's make a <code>Location</code> struct that takes a <code>CLLocationCoordinate2D</code> object and has a <code>id</code> that is a <code>UUID</code>:</p><pre><code><span class="keyword">struct</span> Location: <span class="type">Identifiable</span> {
  <span class="keyword">var</span> center: <span class="type">CLLocationCoordinate2D</span>
  <span class="keyword">let</span> id = <span class="type">UUID</span>()
}
</code></pre><p>We happen to have a CLLocationCoordiante2D handy from our <code>MKCoordinateRegion</code> we defined earlier, so let's use that to define our <code>Location</code></p><pre><code><span class="keyword">let</span> annotations = [<span class="type">Location</span>(center: region.<span class="property">center</span>)]
</code></pre><p>Then we need to complete the closure for <code>annotationContent</code> to display this on the map. There are a few different ways we can do that. First we can use a <code>MapMarker</code></p><pre><code>   <span class="type">MapMarker</span>(coordinate: annotations[<span class="number">0</span>].center)
</code></pre><p>This takes in the <code>CLLocationCoordinate2D</code> from our <code>Location</code> as well as an optional <code>tint</code>. This produces a larger marker that looks like this:</p><img src="../../../week05/MapMarker.png#centerResized" alt="ApplePark"/><p>You may be more familiar with <code>MapPin</code>s however, which takes in the same argument:</p><pre><code>   <span class="type">MapPin</span>(coordinate: annotations[<span class="number">0</span>].center)
</code></pre><img src="../../../week05/MapPin.png#centerResized" alt="ApplePark"/><p class="new"> NOTE: as of iOS 16, MapPin has been DEPRECATED, and will no longer be available in a future release of iOS</p><p>The last possibility for an annotation is one that you make yourself - SwiftUI to the rescue! You can define your own content to go on the maps thanks to a <code>MapAnnotation</code>, which again takes in a coordinate but also has a closure that lets you define the content you want to display</p><pre><code>   <span class="type">MapAnnotation</span>(coordinate: annotations[<span class="number">0</span>].center) {
    <span class="type">VStack</span> {
     <span class="type">Image</span>(systemName: <span class="string">"star.fill"</span>)
     <span class="type">Text</span>(<span class="string">"The Spaceship"</span>)
    }
  }
</code></pre><img src="../../../week05/MapAnnotation.png#centerResized" alt="ApplePark"/><p>Remember, thanks to SwiftUI and its composability, you can put <em>anything</em> you want in that closure!</p><h2>A Missing Component</h2><p>Even the SwiftUI Map view is powerful - but it isn't anything without the <code>CoreLocation</code> framework to tell it where the user is - and we'll cover that in the next module.</p><p style="float: left">Previous:  <A HREF="../03-CoreMotionExample/index.html">CoreMotion Example</A></p><p style="float: right">Next:  <A HREF="../05-IntroductionToCoreLocation/index.html" class="nextModule">Introduction to Core Location</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated August 27, 2023 at 8:04 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>